---
title: "Process&Thread"
date: 2020-07-05 16:45:28 -0400
categories: OS_Study
---

# 프로세스의 개념
프로세스의 개념
- 실행 중인 프로그램
- 비동기적 행위
- 실행 중인 프로시저(== 하나의 프로세스 ~ 태스크)
- 실행 중인 프로시저의 제어 추적
- 운영체제에 들어 있는 프로세스 제어 블록(PCB)
- 프로세서에 할당하여 실행할 수 있는 개체 디스패치(프로세스 자원 할당)가 가능한 대상

프로그램이 실행 중이다 라는 의미는 디스크에 있던 프로그램을 메모리에 적재하여 운영체제의 제어를 받는 상태가 됨을 의미함

프로세스는 메모리 구조를 이루고, PC나 레이스터처럼 현재 어떤 자원을 사용하는지 관련 정보가 들어있는 동적 객체임
스택 / 힙 / 데이터 / 코드 영역으로 이루어짐
- 스택:
-데이터를 일시적으로 저장하는 영역.
-호출한 함수의 반환 주소, 반환 값, 매개변수 등에 사용
- 힙
-코드 영역과는 별도로 유지되는 자유 영역
-동적으로 메모리를 할당하려고 프로그램 실행 중 시스템 호출을 사용했다가 해제하는 방법으로 활용됨
- 데이터
-프로그램의 가상 주소 공간
-전역변수, 정적변수를 저장하거나 할당하고 실행하기 전에 초기화함
- 코드
-실행 명령을 포함하는 메모리이거나 목적 파일에 있는 프로그램 영역
-프로세서가 디스크에서 읽어 실행하는 컴파일한 프로그램을 저장
-읽기 전용이며 공유할 수 있음

스케줄러는 디스크에 저장된 프로그램에 프로세서를 할당해서 장치나 메모리 같은 파일 자원을 참조하고, 프로세스를 지원하며 교착 상태, 보호, 동기화 같은 정보를 교환함


# 프로세스의 상태 변화와 상태 정보

운영체제는 프로세스의 실행을 제어하며, 프로세스는 실행하면서 상태가 변하므로 운영체제는 프로세스 제어에 필요한 상태를 점검하고 프로세스를 제어함

- 프로세스의 상태 변화
-실행/비실행 상태로 나뉨
-운영체제가 프로세스를 생성하면 비실행 상태로 초기화되어 실행을 기다림
-실행중인 프로스세를 종료하거나 인터럽트가 발생하면 비실행 프로세스 중 선택한 프로세스를 실행 상태로 변경(디스패치)
-위의 상태에서 인터럽트된 프로세스는 비실행 상태가 됨
-실행 중인 프로세스는 새로운 자원을 할당받으려고 프로세서를 기다리는 비실행 상태로 바뀌기도 함


![Process_Status_.PNG](C:\Users\User\Desktop\운영체제 블로그 그림\Process_Status_.PNG)

-프로세스는 시스템에서 준비 / 실행 / 대기 상태로 바뀌면서 시스템을 떠날 때까지 이 과정을 반복함
-운영체제가 프로세스 스케줄러를 이용하여 관리
-실행 상태의 프로세스가 프로세서를 자발적으로 반환하기 전에 할당된 시간이 지나면 준비상태가 됨
-프로세스를 실행하다 IO명령 또는 시간이 많이 필요한 비슷한 요청이 발생하면 대기 상태가 됨
-대기 상태의 프로세스는 대기 원인을 제거하면 준비 상태가 됨
-디스패처가 준비 상태인 프로세스에 프로세서를 할당하면 다시 실행 상태가 됨
-디스패처 : 스케줄러가 선택한 프로세스에 프로세서를 할당하는 모듈. 준비 큐에서 프로세스를 선택함

- 프로세스 제어 블록
-운영체제가 프로세스를 제어할 때 필요한 프로세스 상태 정보를 저장하는 곳
-프로세스 식별자, 프로세스 상태, PC, 레지스터 저장 영역, 프로세서 스케줄링 정보, 계정 정보, 입출력 상태 정보, 메모리 관리 정보 등을 지니고 있음

- 프로세스 컨텍스트 스위칭
-정의 : 인터럽트나 시스템 호출 등으로 실행 중인 프로세스의 제어를 다른 프로세스에 넘겨 실행 상태가 되도록 하는 것



* * *

# 프로세스의 관리
- 프로세스의 생성
-프로세스를 생성하면, 운영체제는 다음을 수행함
-- 1.새로운 프로세스에 프로세스 식별자를 할당
-- 2.프로세스의 모든 구성 요소를 포함할 수 있는 주소 공간과 프로세스 제어 블록 공간을 할당
-- 3.프로세스 제어 블록을 초기화
-- 4.큐에 삽입함

- 프로세스의 종료
-프로세스가 마지막 명령을 실행하면 종료하여 운영체제에 프로세스 삭제를 요청
-인터럽트를 발생하거나 시스템 호출로 중단 명령을 전달하여 프로세스를 종료

- 프로세스의 제거
-프로세스를 제거하면 사용하던 자원을 시스템에 돌려주고, 해당 프로세스는 시스템 리스트나 테이블에서 사라져 PCB를 회수함

- 프로세스의 중단과 재시작
-시스템에 장애가 발생하면 실행 중인 프로세스는 잠시 중단했다가 시스템이 기능을 회복할 때 다시 재시작
-프로세스에 의심스러운 부분이 있으면 실행 중인 프로세스를 중단하여 확인 후 재시작 혹은 종료
-처리할 작업이 너무 많아 시스템에 부담이 되면 프로세스 몇 개를 중단했다가 시스템이 정상 상태로 다시 돌아왔을 때 재시작
-대다수 시스템은 프로세스를 실행하기 전에 자원을 할당받고 실행을 시작함
-다중 프로그래밍 환경에서는 자원의 이용률과 시스템의 효율을 위하여 자원을 동적으로 할당함
-자원을 할당받으려고 기다리는 상태가 대기, 할당받은 자원을 기다리는 상태가 중단 상태임
-짧은 시간에 너무 많은 프로세스를 요청하면 프로세스 몇개가 중단됨
-장시간 중단할 때는 해당 프로세스에 할당된 자원을 다시 돌려주는데, 자원의 성질에 따라서 돌려줄 자원을 결정함



![Process_Status__.PNG](C:\Users\User\Desktop\운영체제 블로그 그림\Process_Status__.PNG)


- 프로세스의 컨텍스트 스위칭
-현재 실행하는 프로세스와는 별도로 외부에서 이벤트가 일어나면 인터럽트가 발생함
--입출력 인터럽트 : 입출력 동작이 발생함을 확인하고 프로세스를 준비 상태로 바꾼 후 실행할 프로세스를 결정
--클록 인터럽트 : 현재 실행 중인 프로세스의 할당 시간을 조사하여 실행 중인 프로세스를 준비 상태로 바꾸고, 다른 프로세스를 실행 상태로 바꿈
-실행중인 프로세스에 인터럽트가 발생하면 운영체제가 다른 프로세스를 실행 상태로 바꾸고 제어를 넘겨줌
-이전 프로세스의 상태 레지스터 내용을 보관하고 다른 프로세스의 레지스터를 적재하여 프로세스를 교환하는 것을 컨텍스트 스위칭이라 함




* * *

# 스레드의 개념과 상태 변화
- 스레드의 개념
-프로세스는 자원과 제어로 구분됨. 이 중 제어만 분리한 실행의 단위를 스레드라고 함
-스레드들은 프로세스 관리 정보를 공유함
--PC, SP, 문맥 정보, 지역 데이터, 스택은 독립적으로 가짐
--코드, 전역 데이터, 힙은 다른 스레드들과 공유함
--PC가 독립적이므로, 같은 프로세스의 스레드들이 동시에 코드의 다른 부분을 실행할 수 있음
-스레드의 이점
--사용자 응답성 증가
--프로세스의 자원과 메모리 공유 가능
--경제성이 좋음
--다중 처리로 성능과 효율 향상

- 스레드 제어 블록
-TCB에서는 다음을 저장함
--실행 상태 : 프로세서 레지스터, PC, SP
--스케줄링 정보 : 상태(실행, 준비, 대기), 우선순위, 프로세서 시간

- 사용자 수준 스레드
-스레드 교환에 커널이 개입하지를 않아서 커널에서 사용자 영역으로 전환하지 않음
-커널은 스레드가 아닌 프로세스를 한 단위로 인식하고 프로세서를 할당함(다수의 사용자 수준 스레드는 커널 수준에선 하나의 스레드로 인식)
-커널모드로 들어갈 필요가 없어 오버헤드가 적으며, 커널에 독립적이어서 이식성이 높음
-반면 시스템의 동시성을 지원하지 않고, 스레드 간 보호를 할 수 없고, 커널이 한 프로세스에 속한 여러 스레드에 프로세서를 동시에 할당할 수 없어 다중 처리 시스템에서 규모를 확장하기 어려움

- 커널 수준 스레드
-커널이 스레드와 관련된 모든 작업을 관리함
-한 프로세스에서 다수의 스레드가 프로세서를 할당받아 병행 수행 가능
-다른 스레드로 변경할 시 커널이 개입하므로, 사용자 영역에서 커널 영역으로 전환이 필요함
-커널이 전체 프로세스와 스레드 정보를 유지하여 오버헤드가 커짐

- 스레드 풀링
-시스템이 관리하는 스레드의 풀을 응용 프로그램에 제공하여 스레드를 효율적으로 사용할 수 있게 하는 방법
-미리 생성한 스레드를 재사용하도록 하여 스레드 생성 시간을 줄여 시스템 부담을 줄임
-동시에 생성할 수 있는 스레드 수를 제한하여 시스템의 자원 소비를 줄여 응용 프로그램의 전체 성능을 일정 수준으로 유지함